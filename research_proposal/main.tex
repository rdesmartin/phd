\documentclass[]{article}

%opening
\title{Research Proposal: Verification of Neural Networks in Imandra}
\author{Remi Desmartin}

\begin{document}

\maketitle

\iffalse
\begin{abstract}

\end{abstract}
\fi

\section{Background}
% Critical software systems are increasingly complex, so they benefit from formal verification
The increased complexity of critical software systems has made traditional testing tools insufficient for detecting edge failure cases. One solution, which has gained momentum in the recent years, is the use of formal methods, that use rigorous mathematical tools to model the system, formulate specifications and verify that they are met \cite{newcombe_how_2015}. 

% ML is involved in these systems, so it needs to be verified.
The introduction of artificial intelligence (AI) components, often relying on machine learning (ML) algorithms is a contributing factor in the complexification of safety-critical systems. Neural networks (NN), a group of ML algorithm, have shown exceptional performance at dealing with noisy data and have been deployed in safety-critical applications like autonomous cars \cite{} or automated trading agents \cite{bao_deep_2017}. Because ML components' failure can lead to the of the whole system's failure \cite{dreossi_compositional_2017}, formally verifying the system necessarily involves verifying the ML component.

% Imandra is a formal verification tool that targets complex systems.
Imandra~\cite{passmore_imandra_2020} is a verification tool that has been successfully applied to verifying complex systems in the FinTech
domain~\cite{passmore_lessons_2021}, like trading algorithms and blockchain smart contract infrastructure. It combines features of both functional languages and interactive and automated theorem provers. Imandra's logic is based on a pure, higher-order subset of OCaml, and
functions written in Imandra are at the same time valid OCaml code that can be
executed. 

Imandra's mode of interactive proof
development is based on a typed, higher-order lifting of the \emph{Boyer-Moore
	waterfall}~\cite{boyer_computational_1979} for automated induction, tightly integrated with novel
techniques for SMT modulo recursive functions. 
In short, Imandra is both a functional programming language in which programs can be implemented and executed, and a reasoning engine which can apply formal verification techniques to these programs.

% Quick overview of NN verification
The biggest shortcoming of NNs is their sensitivity to small variations in the input; this sensitivity can be actively exploited by \emph{adversarial attacks} \cite{carlini_towards_2017}. Thus, verifying ML components (especially NNs) has been the focus of recent research, essentially divided into SMT-based tools \cite{katz_reluplex_2017} and those based on abstract interpretation \cite{singh_abstract_2019, elboher_abstraction-based_2020}. A large part of verification efforts focus on proving that NNs are resistant to adversarial attacks, i.e. they classify consistently examples that are close within the input space. This property is called robustness; multiple formal definitions of it are used \cite{casadio_property-driven_2021}. Even though it is the primary focus of NN verification its scope is limited. Other properties like fairness or domain-specific property are also desirable and worthy of investigation.


\section{Research Question}
%Section 2. If it is a section "Research question", then try to formulate just one: eg is Imandra the right programming language/verification tool to enable a wider range of NN verification tasks than was possible before. And then you can have those other research questions

% Limitations: usually not flexible (limited to specific classes of NN or property type) and not well-integrated into larger verification frameworks
Currently, verification of ML algorithms such as neural networks requires dedicated tools. These tools are often limited to narrow use cases: a single family of NNs (e.g. MLP with Relu activation, RNN) or a single type of properties (e.g. a single definition of robustness). In addition, the integration into more generic and verification frameworks that are able to certify the larger systems containing ML.

There is a need for a flexible and generic NN verification framework that allows building systems with ML components with strong safety and security guarantees.

Thus, we will try to investigate the question: is Imandra the right tool to enable a wider range of verification tasks than is currently available?

In order to answer this research question, we will investigate:
\begin{enumerate}
	\item The role of ML-components in complex systems (e.g. simple inputs to controllers, or controllers themselves);
	\item The verification of NN components;
	\item The integration of ML components' verification in larger verification frameworks
\end{enumerate}

We will remain open to new questions as they surely will arise from these initial explorations.


\section{Aims}

% Aims and objectives could be improved. Just one big aim, I think -- to build comprehensive NN verification facilities/libraries in Imandra. Then think about 5 concrete objectives. One of your three objectives (no 2) looks like an objective to me

Our aim is to make designing, implementing and deploying trustworthy software easier by building a comprehensive NN verification library in Imandra.

To that end, our objectives are the following:
\begin{enumerate}
\item integrate third-party NN verifiers into a generic verification tool like Imandra
\item support verification of advanced NN architectures such as convolutional NNs
\item facilitate interoperability with other machine learning tools by implementing the ONNX standard in Imandra
\item demonstrate the integration of ML components verification to larger systems verification.
\end{enumerate}

\section{Methodology}
%Methodology: outline the methodology we developed for the ITP paper, say that widening it will be the way to go, may be say which parts of it specifically need further development

Initial research has been conducted as part of my Master's thesis. So far, we have managed to implement different formalisation of NNs in Imandra and multiple specifications of desirable properties for NNs. Thanks to these implementations, we were able to show that the expressivity of Imandra's programming language and its tight coupling with a range of automated reasoning techniques enables the verification of a range of properties. Notably, we have verified properties on compressed versions of some networks from the the ACAS Xu benchmark~\cite{katz_reluplex_2017}.

Our plan is to pursue this effort, by further developing the library. Possible directions include creating a ``library'' of proved lemmas to help Imandra to reason about more complex or larger networks, and interfacing our library with external reasoning tools.

In the medium term and depending on results, it will be interesting to evaluate our library against standard NN Verification benchmarks such as the ones proposed by the VNN-Comp~\cite{noauthor_vnn_nodate}.

\section{Research Environment and Supervision}
%3. The Edinburgh Center for Robotics: engagement with broader range of AI academics and industries, extra training

Imandra will provide infrastructural support for this research, in the form of funding and guidance throughout of the project.
Prof. Ekaterina Komendentskaya, Prof. Kathrin Stark, and Dr. Grant Passmore will co-supervise this research. Passmore is the creator of Imandra and the co-founder and co-CEO of the company that comercialises it.

The research will benefit from the environment of the lab for AI Verification (LAIV). It will be enriched by attending the lab's seminars and schools and discussions with the lab's members.
 
The research will also be conducted as part of the Edinburgh Center for Robotics. Its ecosystem will allow us to reach a broader range of academics and industry experts in the field of AI, as well as provide additional training opportunities.


\section{Feasibility}
% Section 6 feasibility: again outline what was proven feasible in the ITP draft, what your hypotheses are about other easy and challenging parts
We have already started the implementation of a library for verifying convolutional NNs. With this library were able to verify robustness on quantised convolutional neural networks, to reason by induction on individual layers and to use the same formalisation to improve network explainability.

We are confident that we will be able to extend this library to improve its performance and the range of supported verification properties and network architectures. One challenging task will be to implement the ONNX (open neural network exchange format) standard; but if we manage to do it, it will open the way to a smooth integration with other tools implementing this standard. 

In terms of infrastructure, we will benefit from Imandra's financial and technical backing. Imandra's support has already proved to be of great help in the first steps of this project and it will doubtlessly continue to do so.



\section{Potential Impact}
Doing this research within the LAIV would allow to contribute to the discussion and research on NN verification, in particular by presenting early results to seminars organised by the LAIV and to specialised conferences like FoMLAS. Major results and milstones will be published in top conferences in the area: for example, ITP, CAV, IJCAR, ICFP.

This project will result in a Neural Network library in Imandra, parts of which could be directly used by researchers in industry and academia. Its general methodological findings can be used indirectly as an inspiration in other similar verification projects. 

The partnership with Imandra means that successful results would impact directly their users by allowing them to formally verify their ML-based systems.

\bibliography{research-proposal} 
\bibliographystyle{acm}
\end{document}



\iffalse
I'd rather deploy a strategy that says: Here is Imandra and its various applications. These various applications may have ML/AI components in the future. This thesis will investigate (a) role of ML/AI components of complex systems (b) methods of verification of these (c) methods for integration of various AI/ML verification components into larger verification projects (d) The project will produce a fully functional AI/ML library in Imandra, which will include domain-specific proof heuristics.








Section 6 feasibility: again outline what was proven feasible in the ITP draft, what your hypotheses are about other easy and challenging parts



\fi